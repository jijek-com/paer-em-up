(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(r){if(r.ep)return;r.ep=!0;const c=n(r);fetch(r.href,c)}})();const t={currentScreen:"start",currentMode:null,grid:[],score:0,timer:0,timerInterval:null,selectedCells:[],gameOver:!1,assists:{hints:{uses:0,max:1/0},revert:{uses:0,max:1},addNumbers:{uses:0,max:10},shuffle:{uses:0,max:5},eraser:{uses:0,max:5}},history:[],settings:{audio:!0,theme:"light"},results:[],totalCellsAdded:27},a={screens:{},startScreen:{},gameScreen:{},resultsScreen:{},modeButtons:{},continueButton:{},settingsButton:{},resultsButton:{},gameGrid:{},scoreDisplay:{},timerDisplay:{},modeInfo:{},controlButtons:{},assistButtons:{},settingsModal:{},resultsModal:{},outcomeModal:{}},x={select:new Audio("./assets/sounds/select.mp3"),valid:new Audio("./assets/sounds/valid.mp3"),invalid:new Audio("./assets/sounds/invalid.mp3"),assist:new Audio("./assets/sounds/assist.mp3"),win:new Audio("./assets/sounds/win.mp3"),lose:new Audio("./assets/sounds/lose.mp3")},p=[1,2,3,4,5,6,7,8,9,1,1,1,2,1,3,1,4,1,5,1,6,1,7,1,8,1,9],V=()=>{const s=a.screens.start,e=document.createElement("h1");e.className="game-title",e.textContent="Pair 'em Up",s.appendChild(e);const n=document.createElement("div");n.className="author-credit",n.innerHTML='Created by <a href="https://github.com/jijek-com" target="_blank">Jijekcom</a>',s.appendChild(n);const o=document.createElement("div");o.className="mode-selection";const r=[{id:"classic",name:"Classic Mode"},{id:"random",name:"Random Mode"},{id:"chaotic",name:"Chaotic Mode"}];a.modeButtons={},r.forEach(i=>{const u=document.createElement("button");u.className="mode-btn",u.textContent=i.name,u.dataset.mode=i.id,o.appendChild(u),a.modeButtons[i.id]=u}),s.appendChild(o),a.continueButton=document.createElement("button"),a.continueButton.className="continue-btn",a.continueButton.textContent="Continue Game",a.continueButton.disabled=!0,s.appendChild(a.continueButton);const c=document.createElement("div");c.className="settings-results-container",a.settingsButton=document.createElement("button"),a.settingsButton.className="settings-btn",a.settingsButton.textContent="Settings",c.appendChild(a.settingsButton),a.resultsButton=document.createElement("button"),a.resultsButton.className="results-btn",a.resultsButton.textContent="Results",c.appendChild(a.resultsButton),s.appendChild(c)};let R=!1;const z=()=>{R||(R=!0,Object.values(x).forEach(s=>{s.preload="auto",s.volume=.7}),Object.values(x).forEach(s=>{const e=()=>{console.warn(`Audio file not found: ${s.src}`),s.removeEventListener("error",e),s.removeAttribute("src"),s.load()};s.addEventListener("error",e)}))},g=s=>{t.settings.audio&&x[s]&&(x[s].currentTime=0,x[s].play().catch(e=>{console.log("Audio play failed:",e)}))},A=(s=0)=>{clearInterval(t.timerInterval),t.timer=s,q(),t.timerInterval=setInterval(()=>{t.timer++,q()},1e3)},q=()=>{a.timerDisplay&&(a.timerDisplay.textContent=I(t.timer))},I=s=>{const e=Math.floor(s/60),n=s%60;return`${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`},w=()=>{a.scoreDisplay&&(a.scoreDisplay.textContent=`Score: ${t.score} / 100`),a.modeInfo&&(a.modeInfo.textContent=`Mode: ${t.currentMode}`);const s=document.getElementById("progress-bar");if(s){const e=Math.min(t.score/100,1);s.style.width=`${e*100}%`}L(),b()},O=()=>{localStorage.setItem("pairEmUp_settings",JSON.stringify(t.settings))},K=()=>{localStorage.setItem("pairEmUp_results",JSON.stringify(t.results))},D=()=>{const s=localStorage.getItem("pairEmUp_savedGame");if(s)try{const e=JSON.parse(s);return t.currentMode=e.mode,t.grid=e.grid,t.score=e.score,t.timer=e.timer,t.selectedCells=e.selectedCells,t.assists=e.assists,t.history=e.history,t.gameOver=!1,t.totalCellsAdded=e.totalCellsAdded||0,t.classicSequenceIndex=e.classicSequenceIndex||0,A(t.timer),f(),w(),!0}catch(e){return console.error("Error loading saved game:",e),!1}return!1},W=()=>{const s=localStorage.getItem("pairEmUp_settings");if(s)try{t.settings={...t.settings,...JSON.parse(s)},$(t.settings.theme);const o=document.getElementById("audio-toggle");o&&(o.checked=t.settings.audio),document.querySelectorAll(".theme-btn").forEach(r=>{r.classList.toggle("active",r.dataset.theme===t.settings.theme)})}catch(o){console.error("Error loading settings:",o)}const e=localStorage.getItem("pairEmUp_results");if(e)try{t.results=JSON.parse(e)}catch(o){console.error("Error loading results:",o)}const n=localStorage.getItem("pairEmUp_savedGame");a.continueButton&&(a.continueButton.disabled=!n)},F=()=>{const s={mode:t.currentMode,grid:t.grid,score:t.score,timer:t.timer,selectedCells:t.selectedCells,assists:t.assists,history:t.history,totalCellsAdded:t.totalCellsAdded,classicSequenceIndex:t.classicSequenceIndex};localStorage.setItem("pairEmUp_savedGame",JSON.stringify(s)),N("Game saved successfully!"),g("assist")},Q=()=>{const s=localStorage.getItem("pairEmUp_savedGame");if(!s)return!1;try{const e=JSON.parse(s);return e.mode===t.currentMode&&JSON.stringify(e.grid)===JSON.stringify(t.grid)&&e.score===t.score}catch{return!1}},$=s=>{s==="dark"?document.body.classList.add("dark-theme"):document.body.classList.remove("dark-theme")},j=s=>{t.settings.theme=s,$(s),O(),document.querySelectorAll(".theme-btn").forEach(e=>{e.classList.toggle("active",e.dataset.theme===s)})},X=()=>{const s=a.screens.results,e=document.createElement("h2");e.textContent="Game Results",s.appendChild(e);const n=document.createElement("button");n.className="control-btn",n.textContent="Back to Start",n.addEventListener("click",()=>y("start")),s.appendChild(n)},U=()=>{const s=document.querySelector("#results-table tbody");if(!s){console.error("Results table body not found");return}s.innerHTML="";const e=l=>{const[d,m]=l.split(":").map(Number);return d*60+m},n=l=>[...l].sort((d,m)=>e(d.time)-e(m.time)).slice(0,5),o=l=>{const d=document.createElement("tr"),m=document.createElement("td");return m.colSpan=4,m.textContent=l,m.style.fontWeight="bold",m.style.textAlign="center",m.style.backgroundColor="var(--cell-border)",d.appendChild(m),d},r=(l,d)=>{const m=document.createElement("tr"),C=document.createElement("td");C.textContent=l.mode,m.appendChild(C);const G=document.createElement("td");G.textContent=l.score,m.appendChild(G);const T=document.createElement("td");T.textContent=l.time,m.appendChild(T);const B=document.createElement("td");return B.textContent=d?"Win":"Loss",B.className=d?"win-indicator":"loss-indicator",m.appendChild(B),m},c=t.results.filter(l=>l.win),i=t.results.filter(l=>!l.win),u=n(c),h=n(i);u.length>0&&(s.appendChild(o("Победы")),u.forEach(l=>{s.appendChild(r(l,!0))})),h.length>0&&(s.appendChild(o("Проигрыши")),h.forEach(l=>{s.appendChild(r(l,!1))}))},E=s=>{const e=document.getElementById(`${s}-modal`);e&&e.classList.add("active")},v=s=>{const e=document.getElementById(`${s}-modal`);e&&e.classList.remove("active")},N=s=>{const e=document.getElementById("alert-message");e&&(e.textContent=s),E("alert")},H=s=>new Promise(e=>{const n=document.getElementById("confirm-message");n&&(n.textContent=s);const o=document.getElementById("confirm-yes"),r=document.getElementById("confirm-no"),c=()=>{o.removeEventListener("click",i),r.removeEventListener("click",u),v("confirm")},i=()=>{c(),e(!0)},u=()=>{c(),e(!1)};o.addEventListener("click",i),r.addEventListener("click",u),E("confirm")}),S=(s,e)=>{const n=document.createElement("div");n.className="modal",n.id=`${s}-modal`;const o=document.createElement("div");o.className="modal-content";const r=document.createElement("div");r.className="modal-header";const c=document.createElement("div");c.className="modal-title",c.textContent=e;const i=document.createElement("button");return i.className="close-modal",i.innerHTML="&times;",i.addEventListener("click",()=>v(s)),r.appendChild(c),r.appendChild(i),o.appendChild(r),n.appendChild(o),{modal:n,content:o}},Z=()=>{const{modal:s,content:e}=S("settings","Settings"),n=document.createElement("div");n.className="settings-option";const o=document.createElement("label"),r=document.createElement("input");r.type="checkbox",r.id="audio-toggle",r.checked=t.settings.audio,o.appendChild(r),o.appendChild(document.createTextNode("Enable Sound Effects")),n.appendChild(o),e.appendChild(n);const c=document.createElement("div");c.className="settings-option";const i=document.createElement("div");i.textContent="Theme:",c.appendChild(i);const u=document.createElement("div");u.className="theme-selector";const h=t.settings.theme||"light",l=document.createElement("button");l.className=`theme-btn ${h==="light"?"active":""}`,l.textContent="Light",l.dataset.theme="light",l.addEventListener("click",()=>j("light"));const d=document.createElement("button");return d.className=`theme-btn ${h==="dark"?"active":""}`,d.textContent="Dark",d.dataset.theme="dark",d.addEventListener("click",()=>j("dark")),u.appendChild(l),u.appendChild(d),c.appendChild(u),e.appendChild(c),s},ee=()=>{const{modal:s,content:e}=S("results","Game Results"),n=document.createElement("table");n.className="results-table",n.id="results-table";const o=document.createElement("thead"),r=document.createElement("tr");["Mode","Score","Time","Result"].forEach(i=>{const u=document.createElement("th");u.textContent=i,r.appendChild(u)}),o.appendChild(r),n.appendChild(o);const c=document.createElement("tbody");return n.appendChild(c),e.appendChild(n),s},te=()=>{const{modal:s,content:e}=S("outcome","Game"),n=document.createElement("div");n.className="outcome-message",n.id="outcome-message",e.appendChild(n);const o=document.createElement("div");o.className="outcome-details",o.id="outcome-details",e.appendChild(o);const r=document.createElement("div");r.className="post-game-options";const c=(i,u)=>{const h=document.createElement("button");return h.className="control-btn",h.textContent=i,h.addEventListener("click",u),h};return r.appendChild(c("Play Again",()=>{v("outcome"),k(t.currentMode)})),r.appendChild(c("Main Menu",()=>{v("outcome"),y("start")})),r.appendChild(c("View Results",()=>{v("outcome"),U(),E("results")})),e.appendChild(r),s},se=()=>{const{modal:s,content:e}=S("alert","Information"),n=document.createElement("div");n.className="alert-message",n.id="alert-message",e.appendChild(n);const o=document.createElement("button");return o.className="control-btn",o.textContent="OK",o.addEventListener("click",()=>v("alert")),e.appendChild(o),s},ne=()=>{const{modal:s,content:e}=S("confirm","Confirmation"),n=document.createElement("div");n.className="confirm-message",n.id="confirm-message",e.appendChild(n);const o=document.createElement("div");o.className="confirm-buttons";const r=document.createElement("button");r.className="control-btn confirm-yes",r.textContent="Yes",r.id="confirm-yes";const c=document.createElement("button");return c.className="control-btn confirm-no",c.textContent="No",c.id="confirm-no",o.appendChild(r),o.appendChild(c),e.appendChild(o),s},oe=()=>{[{name:"settings",creator:Z},{name:"results",creator:ee},{name:"outcome",creator:te},{name:"alert",creator:se},{name:"confirm",creator:ne}].forEach(({name:e,creator:n})=>{a[`${e}Modal`]=n(),document.body.appendChild(a[`${e}Modal`])})},P=()=>{const s=[],e=[];for(let n=0;n<t.grid.length;n++)for(let o=0;o<t.grid[n].length;o++)t.grid[n][o]!==null&&e.push({row:n,col:o,value:t.grid[n][o]});for(let n=0;n<e.length;n++)for(let o=n+1;o<e.length;o++){const r=e[n],c=e[o];(r.value===c.value||r.value+c.value===10)&&Y(r,c)&&s.push({cell1:r,cell2:c})}return s},re=()=>{if(t.history.length>0&&t.assists.revert.uses<t.assists.revert.max){const s=t.history.pop();t.grid=s.grid,t.score=s.score,t.selectedCells=s.selectedCells,t.assists.revert.uses++,b(),w(),f(),g("assist")}},ae=()=>{let s=0;for(let e=0;e<t.grid.length;e++)for(let n=0;n<t.grid[e].length;n++)t.grid[e][n]!==null&&s++;return s},ce=s=>{document.querySelectorAll(".cell").forEach(n=>{n.classList.remove("hint-highlight")}),s.forEach(n=>{const o=document.querySelector(`.cell[data-row="${n.cell1.row}"][data-col="${n.cell1.col}"]`),r=document.querySelector(`.cell[data-row="${n.cell2.row}"][data-col="${n.cell2.col}"]`);o&&r&&(o.classList.add("hint-highlight"),r.classList.add("hint-highlight"))}),setTimeout(()=>{document.querySelectorAll(".cell").forEach(o=>{o.classList.remove("hint-highlight")})},3e3)},le=()=>{const s=P(),e=s.length,n=document.getElementById("hints-counter");e>5?n.textContent="5+":n.textContent=e.toString(),ce(s),g("assist")},ie=()=>{if(t.assists.shuffle.uses<t.assists.shuffle.max){t.assists.shuffle.uses++;const s=[];for(let n=0;n<t.grid.length;n++)for(let o=0;o<t.grid[n].length;o++)t.grid[n][o]!==null&&s.push(t.grid[n][o]);_(s);let e=0;for(let n=0;n<t.grid.length;n++)for(let o=0;o<t.grid[n].length;o++)t.grid[n][o]!==null&&(t.grid[n][o]=s[e],e++);b(),f(),g("assist")}},_=s=>{for(let e=s.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[s[e],s[n]]=[s[n],s[e]]}return s},de=()=>{t.assists.eraser.uses<t.assists.eraser.max&&(t.eraserActive=!0,t.assists.eraser.uses++,b(),g("assist"),N("Click on any number to remove it. This will use one eraser."))},ue=()=>{if(t.timerInterval&&(clearInterval(t.timerInterval),t.timerInterval=null),!Q()&&!H("Your progress is not saved. Are you sure you want to return to the main menu?")){t.gameOver||A();return}O(),y("start"),g("assist")},me=s=>{let e=0,n=Math.floor(t.totalCellsAdded/9),o=t.totalCellsAdded%9;for(;e<s.length;){if(n>=t.grid.length){if(t.grid.length>=50)break;t.grid.push(Array(9).fill(null))}t.grid[n][o]=s[e],e++,t.totalCellsAdded++,o++,o>=9&&(n++,o=0)}},he=()=>{if(t.grid.length>=50){N("Grid limit reached! Cannot add more numbers.");return}if(t.assists.addNumbers.uses<t.assists.addNumbers.max){t.assists.addNumbers.uses++;const s=[],e=ae();if(t.currentMode==="classic")for(let n=0;n<e;n++)s.push(p[t.classicSequenceIndex]),t.classicSequenceIndex=(t.classicSequenceIndex+1)%p.length;else if(t.currentMode==="random")for(let n=0;n<e;n++){const o=Math.floor(Math.random()*p.length);s.push(p[o])}else if(t.currentMode==="chaotic")for(let n=0;n<e;n++)s.push(Math.floor(Math.random()*9)+1);me(s),b(),f(),g("assist"),t.grid.length>=50&&N("Grid limit reached! This was the last set of numbers you can add.")}},ge=async()=>{Object.values(a.modeButtons).forEach(s=>{s.addEventListener("click",e=>{const n=e.target.dataset.mode;k(n)})}),a.continueButton.addEventListener("click",()=>{D()&&y("game")}),a.controlButtons.exit.addEventListener("click",()=>{ue()}),a.settingsButton.addEventListener("click",()=>E("settings")),a.resultsButton.addEventListener("click",()=>{U(),E("results")}),a.controlButtons.reset.addEventListener("click",async()=>{await H("Are you sure you want to reset the game?")&&k(t.currentMode)}),a.controlButtons.save.addEventListener("click",F),a.controlButtons.continue.addEventListener("click",()=>{D()&&y("game")}),a.assistButtons.hints.addEventListener("click",le),a.assistButtons.revert.addEventListener("click",re),a.assistButtons.addNumbers.addEventListener("click",he),a.assistButtons.shuffle.addEventListener("click",ie),a.assistButtons.eraser.addEventListener("click",de),document.getElementById("audio-toggle").addEventListener("change",s=>{t.settings.audio=s.target.checked,O()}),[a.settingsModal,a.resultsModal,a.outcomeModal].forEach(s=>{s.addEventListener("click",e=>{e.target===s&&v(s.id.replace("-modal",""))})})},y=s=>{Object.values(a.screens).forEach(e=>{e.classList.remove("active")}),a.screens[s].classList.add("active"),t.currentScreen=s},fe=()=>{const s=a.screens.game,e=document.createElement("div");e.className="game-header",a.modeInfo=document.createElement("div"),a.modeInfo.className="mode-info",a.modeInfo.textContent=`Mode: ${t.currentMode||"Classic"}`,e.appendChild(a.modeInfo),a.scoreDisplay=document.createElement("div"),a.scoreDisplay.className="score-display",a.scoreDisplay.textContent="Score: 0 / 100",e.appendChild(a.scoreDisplay),a.timerDisplay=document.createElement("div"),a.timerDisplay.className="timer-display",a.timerDisplay.textContent="00:00",e.appendChild(a.timerDisplay),s.appendChild(e);const n=document.createElement("div");n.className="progress-container";const o=document.createElement("div");o.className="progress-bar",o.id="progress-bar",n.appendChild(o),s.appendChild(n);const r=document.createElement("div");r.className="game-controls";const c=[{id:"reset",text:"Reset"},{id:"save",text:"Save Game"},{id:"continue",text:"Continue"},{id:"exit",text:"Back to Menu"}];a.controlButtons={},c.forEach(l=>{const d=document.createElement("button");d.className="control-btn",d.id=`${l.id}-btn`,d.textContent=l.text,r.appendChild(d),a.controlButtons[l.id]=d}),s.appendChild(r),a.gameGrid=document.createElement("div"),a.gameGrid.className="game-grid",s.appendChild(a.gameGrid);const i=document.createElement("div");i.className="assist-tools";const u=[{id:"hints",text:"Hints",counter:!0},{id:"revert",text:"Revert",counter:!0},{id:"addNumbers",text:"Add Numbers",counter:!0},{id:"shuffle",text:"Shuffle",counter:!0},{id:"eraser",text:"Eraser",counter:!0}];a.assistButtons={},u.forEach(l=>{const d=document.createElement("button");d.className="assist-btn",d.id=`${l.id}-btn`;const m=document.createElement("span");if(m.textContent=l.text,d.appendChild(m),l.counter){const C=document.createElement("span");C.className="usage-counter",C.id=`${l.id}-counter`,C.textContent="∞",d.appendChild(C)}i.appendChild(d),a.assistButtons[l.id]=d}),s.appendChild(i);const h=document.createElement("button");h.className="settings-btn",h.textContent="Settings",h.style.margin="20px auto 0",h.style.display="flex",s.appendChild(h),h.addEventListener("click",()=>{E("settings")})},pe=()=>{if(t.score>=100){M(!0);return}const s=P(),e=Object.values(t.assists).every(n=>n.uses>=n.max);if(s.length===0&&e){M(!1);return}if(t.grid.length>=50){M(!1);return}},Ce=(s,e)=>{t.grid[s][e]!==null&&(t.grid[s][e]=null,f())},Y=(s,e)=>{if(s.row===e.row&&s.col===e.col)return!1;if(Math.abs(s.row-e.row)===1&&s.col===e.col||Math.abs(s.col-e.col)===1&&s.row===e.row)return!0;if(s.row===e.row){const n=Math.min(s.col,e.col),o=Math.max(s.col,e.col);for(let r=n+1;r<o;r++)if(t.grid[s.row][r]!==null)return!1;return!0}if(s.col===e.col){const n=Math.min(s.row,e.row),o=Math.max(s.row,e.row);for(let r=n+1;r<o;r++)if(t.grid[r][s.col]!==null)return!1;return!0}if(Math.abs(s.row-e.row)===1){const n=s.row<e.row?s:e,o=s.row<e.row?e:s;if(n.col===8&&o.col===0)return!0}return!1},J=()=>{t.selectedCells.forEach(s=>{const e=document.querySelector(`.cell[data-row="${s.row}"][data-col="${s.col}"]`);e&&(e.classList.add("invalid-pair"),setTimeout(()=>{e.classList.remove("invalid-pair")},500))})},L=()=>{const s=document.getElementById("hints-counter");s&&(s.textContent="∞")},ve=()=>{const[s,e]=t.selectedCells,n=t.grid[s.row][s.col],o=t.grid[e.row][e.col];if(!Y(s,e)){g("invalid"),J(),t.selectedCells=[],f();return}let r=0,c=!1;n===5&&o===5?(r=3,c=!0):n===o?(r=1,c=!0):n+o===10&&(r=2,c=!0),c?(g("valid"),t.history.push({grid:JSON.parse(JSON.stringify(t.grid)),score:t.score,selectedCells:[...t.selectedCells]}),t.score+=r,t.grid[s.row][s.col]=null,t.grid[e.row][e.col]=null,t.selectedCells=[],t.assists.revert.uses=0,w(),f(),pe(),L()):(g("invalid"),J(),t.selectedCells=[],f(),L())},M=s=>{t.gameOver=!0,clearInterval(t.timerInterval);const e={mode:t.currentMode,score:t.score,time:I(t.timer),win:s,timestamp:new Date().toISOString()};t.results.unshift(e),t.results.length>5&&t.results.pop(),K();const n=document.getElementById("outcome-message"),o=document.getElementById("outcome-details");s?(n.textContent="Congratulations! You Won!",n.style.color="var(--success-color)",g("win")):(n.textContent="Game Over",n.style.color="var(--accent-color)",g("lose"));const r=document.createElement("p");r.textContent=`Score: ${t.score}`;const c=document.createElement("p");c.textContent=`Time: ${I(t.timer)}`;const i=document.createElement("p");i.textContent=`Mode: ${t.currentMode}`,o.appendChild(r),o.appendChild(c),o.appendChild(i),E("outcome")},b=()=>{const s=document.getElementById("revert-counter");s&&(s.textContent=`${t.assists.revert.uses}/${t.assists.revert.max}`),a.assistButtons.revert.disabled=t.assists.revert.uses>=t.assists.revert.max;const e=document.getElementById("addNumbers-counter");e&&(e.textContent=`${t.assists.addNumbers.uses}/${t.assists.addNumbers.max}`),a.assistButtons.addNumbers.disabled=t.assists.addNumbers.uses>=t.assists.addNumbers.max||t.grid.length>=50;const n=document.getElementById("shuffle-counter");n&&(n.textContent=`${t.assists.shuffle.uses}/${t.assists.shuffle.max}`),a.assistButtons.shuffle.disabled=t.assists.shuffle.uses>=t.assists.shuffle.max;const o=document.getElementById("eraser-counter");o&&(o.textContent=`${t.assists.eraser.uses}/${t.assists.eraser.max}`),a.assistButtons.eraser.disabled=t.assists.eraser.uses>=t.assists.eraser.max},Ee=s=>{if(t.gameOver)return;const e=parseInt(s.target.dataset.row),n=parseInt(s.target.dataset.col);if(isNaN(e)||isNaN(n)){console.error("Invalid cell coordinates:",e,n);return}if(e>=t.grid.length||!t.grid[e]){console.error("Row does not exist in grid:",e,"Grid length:",t.grid.length);return}if(n>=t.grid[e].length||t.grid[e][n]===void 0){console.error("Column does not exist in row:",n,"Row length:",t.grid[e].length);return}if(t.grid[e][n]===null)return;if(t.eraserActive){Ce(e,n),t.eraserActive=!1,b();return}t.selectedCells.some(r=>r.row===e&&r.col===n)?(t.selectedCells=t.selectedCells.filter(r=>!(r.row===e&&r.col===n)),g("select")):(t.selectedCells.length<2&&(t.selectedCells.push({row:e,col:n}),g("select")),t.selectedCells.length===2&&setTimeout(ve,300)),f()},ye=()=>{a.screens={start:document.createElement("div"),game:document.createElement("div"),results:document.createElement("div")},a.screens.start.className="screen start-screen",a.screens.game.className="screen game-screen",a.screens.results.className="screen results-screen",V(),fe(),X(),oe(),document.body.appendChild(a.screens.start),document.body.appendChild(a.screens.game),document.body.appendChild(a.screens.results),a.screens.start.classList.add("active")},be=()=>{ye(),W(),ge(),y("start"),z(),$(t.settings.theme)},f=()=>{a.gameGrid.innerHTML="";for(let s=0;s<t.grid.length;s++)for(let e=0;e<t.grid[s].length;e++){const n=document.createElement("div");n.className="cell",n.dataset.row=s.toString(),n.dataset.col=e.toString(),t.grid[s][e]!==null?(n.textContent=t.grid[s][e],n.addEventListener("click",Ee)):n.classList.add("empty"),t.selectedCells.some(o=>o.row===s&&o.col===e)&&n.classList.add("selected"),a.gameGrid.appendChild(n)}},xe=s=>{if(t.grid=[],t.classicSequenceIndex=0,s==="classic")for(let e=0;e<3;e++){const n=[];for(let o=0;o<9;o++){const r=e*9+o;r<p.length?(n.push(p[r]),t.classicSequenceIndex=(r+1)%p.length):n.push(null)}t.grid.push(n)}else if(s==="random"){const e=[...p];_(e);for(let n=0;n<3;n++){const o=[];for(let r=0;r<9;r++){const c=n*9+r;c<e.length?o.push(e[c]):o.push(null)}t.grid.push(o)}}else if(s==="chaotic")for(let e=0;e<3;e++){const n=[];for(let o=0;o<9;o++)n.push(Math.floor(Math.random()*9)+1);t.grid.push(n)}t.totalCellsAdded=27,f()},k=s=>{t.currentMode=s,t.score=0,t.timer=0,t.selectedCells=[],t.gameOver=!1,t.history=[],t.totalCellsAdded=0,t.classicSequenceIndex=0,Object.keys(t.assists).forEach(e=>{t.assists[e].uses=0}),t.assists.revert.uses=0,xe(s),w(),A(),y("game"),g("assist")};document.addEventListener("DOMContentLoaded",be);
