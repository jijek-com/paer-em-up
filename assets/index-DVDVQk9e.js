(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(r){if(r.ep)return;r.ep=!0;const c=n(r);fetch(r.href,c)}})();const z="/paer-em-up/assets/select-CTcz-kZ7.mp3",F="/paer-em-up/assets/valid-BL_m30Rp.mp3",K="/paer-em-up/assets/invalid-2cgrDoFd.mp3",Z="/paer-em-up/assets/assist-BFpq9UWq.mp3",Q="/paer-em-up/assets/win-DLW7cufj.mp3",X="/paer-em-up/assets/lose-CEU07weh.mp3",s={currentScreen:"start",currentMode:null,grid:[],score:0,timer:0,timerInterval:null,selectedCells:[],gameOver:!1,assists:{hints:{uses:0,max:1/0},revert:{uses:0,max:1},addNumbers:{uses:0,max:10},shuffle:{uses:0,max:5},eraser:{uses:0,max:5}},history:[],settings:{audio:!0,theme:"light"},results:[],totalCellsAdded:27},a={screens:{},startScreen:{},gameScreen:{},resultsScreen:{},modeButtons:{},continueButton:{},settingsButton:{},resultsButton:{},gameGrid:{},scoreDisplay:{},timerDisplay:{},modeInfo:{},controlButtons:{},assistButtons:{},settingsModal:{},resultsModal:{},outcomeModal:{}},N={select:new Audio(z),valid:new Audio(F),invalid:new Audio(K),assist:new Audio(Z),win:new Audio(Q),lose:new Audio(X)},f=[1,2,3,4,5,6,7,8,9,1,1,1,2,1,3,1,4,1,5,1,6,1,7,1,8,1,9],ee=()=>{const e=a.screens.start,t=document.createElement("h1");t.className="game-title",t.textContent="Pair 'em Up",e.appendChild(t);const n=document.createElement("div");n.className="author-credit",n.innerHTML='Created by <a href="https://github.com/jijek-com" target="_blank">Jijekcom</a>',e.appendChild(n);const o=document.createElement("div");o.className="mode-selection";const r=[{id:"classic",name:"Classic Mode"},{id:"random",name:"Random Mode"},{id:"chaotic",name:"Chaotic Mode"}];a.modeButtons={},r.forEach(i=>{const u=document.createElement("button");u.className="mode-btn",u.textContent=i.name,u.dataset.mode=i.id,o.appendChild(u),a.modeButtons[i.id]=u}),e.appendChild(o),a.continueButton=document.createElement("button"),a.continueButton.className="continue-btn",a.continueButton.textContent="Continue Game",a.continueButton.disabled=!0,e.appendChild(a.continueButton);const c=document.createElement("div");c.className="settings-results-container",a.settingsButton=document.createElement("button"),a.settingsButton.className="settings-btn",a.settingsButton.textContent="Settings",c.appendChild(a.settingsButton),a.resultsButton=document.createElement("button"),a.resultsButton.className="results-btn",a.resultsButton.textContent="Results",c.appendChild(a.resultsButton),e.appendChild(c)};let q=!1;const S=new Map,D=new Map,te=()=>{q||(q=!0,Object.entries(N).forEach(([e,t])=>{if(!t){console.warn(`Audio element for ${e} is undefined`);return}t.preload="auto",t.volume=.7;const n=()=>{S.set(e,!0)},o=()=>{console.warn(`Audio file failed to load: ${t.src}`),S.set(e,!1)};t.addEventListener("canplaythrough",n),t.addEventListener("error",o),t.readyState>=3?S.set(e,!0):S.set(e,!1)}))},h=e=>{if(!s.settings.audio||!N[e])return;const t=Date.now(),n=D.get(e)||0;if(t-n<100)return;D.set(e,t);const o=N[e];if(S.get(e))try{o.currentTime=0;const r=o.play();r!==void 0&&r.catch(c=>{c.name!=="NotAllowedError"&&console.warn(`Audio play failed for ${e}:`,c)})}catch(r){console.warn(`Cannot play sound ${e}:`,r)}},se=()=>{Object.values(N).forEach(e=>{e&&e.preload!=="none"&&e.load()})},$=(e=0)=>{clearInterval(s.timerInterval),s.timer=e,j(),s.timerInterval=setInterval(()=>{s.timer++,j()},1e3)},j=()=>{a.timerDisplay&&(a.timerDisplay.textContent=I(s.timer))},I=e=>{const t=Math.floor(e/60),n=e%60;return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`},M=()=>{a.scoreDisplay&&(a.scoreDisplay.textContent=`Score: ${s.score} / 100`),a.modeInfo&&(a.modeInfo.textContent=`Mode: ${s.currentMode}`);const e=document.getElementById("progress-bar");if(e){const t=Math.min(s.score/100,1);e.style.width=`${t*100}%`}k(),b()},O=()=>{try{localStorage.setItem("pairEmUp_settings",JSON.stringify(s.settings))}catch(e){console.error("Error saving settings:",e)}},ne=()=>{try{localStorage.setItem("pairEmUp_results",JSON.stringify(s.results))}catch(e){console.error("Error saving results:",e)}},U=()=>{try{const e=localStorage.getItem("pairEmUp_savedGame");if(!e)return!1;const t=JSON.parse(e);return!t.mode||!t.grid?(console.error("Invalid saved game data"),!1):(s.currentMode=t.mode,s.grid=t.grid,s.score=t.score||0,s.timer=t.timer||0,s.selectedCells=t.selectedCells||[],s.assists=t.assists||{},s.history=t.history||[],s.gameOver=!1,s.totalCellsAdded=t.totalCellsAdded||0,s.classicSequenceIndex=t.classicSequenceIndex||0,$(s.timer),p(),M(),!0)}catch(e){return console.error("Error loading saved game:",e),localStorage.removeItem("pairEmUp_savedGame"),!1}},oe=()=>{try{const e=localStorage.getItem("pairEmUp_settings");if(e){const t=JSON.parse(e);s.settings={...s.settings,...t},G(s.settings.theme||"light");const n=document.getElementById("audio-toggle");n&&(n.checked=!!s.settings.audio),document.querySelectorAll(".theme-btn").forEach(o=>{o.dataset.theme&&o.classList.toggle("active",o.dataset.theme===(s.settings.theme||"light"))})}}catch(e){console.error("Error loading settings:",e)}try{const e=localStorage.getItem("pairEmUp_results");e&&(s.results=JSON.parse(e))}catch(e){console.error("Error loading results:",e),s.results=[]}try{const e=localStorage.getItem("pairEmUp_savedGame");a&&a.continueButton&&(a.continueButton.disabled=!e)}catch(e){console.error("Error checking saved game:",e)}},re=()=>{try{const e={mode:s.currentMode,grid:s.grid,score:s.score,timer:s.timer,selectedCells:s.selectedCells,assists:s.assists,history:s.history,totalCellsAdded:s.totalCellsAdded,classicSequenceIndex:s.classicSequenceIndex};localStorage.setItem("pairEmUp_savedGame",JSON.stringify(e)),B("Game saved successfully!"),h("assist")}catch(e){console.error("Error saving game:",e),B("Error saving game!")}},ae=()=>{try{const e=localStorage.getItem("pairEmUp_savedGame");if(!e)return!1;const t=JSON.parse(e);return t.mode===s.currentMode&&JSON.stringify(t.grid)===JSON.stringify(s.grid)&&t.score===s.score}catch(e){return console.error("Error checking if game is saved:",e),!1}},G=e=>{e==="dark"?document.body.classList.add("dark-theme"):document.body.classList.remove("dark-theme")},P=e=>{s.settings.theme=e,G(e),O(),document.querySelectorAll(".theme-btn").forEach(t=>{t.classList.toggle("active",t.dataset.theme===e)})},ce=()=>{const e=a.screens.results,t=document.createElement("h2");t.textContent="Game Results",e.appendChild(t);const n=document.createElement("button");n.className="control-btn",n.textContent="Back to Start",n.addEventListener("click",()=>y("start")),e.appendChild(n)},H=()=>{const e=document.querySelector("#results-table tbody");if(!e){console.error("Results table body not found");return}e.innerHTML="";const t=l=>{const[d,m]=l.split(":").map(Number);return d*60+m},n=l=>[...l].sort((d,m)=>t(d.time)-t(m.time)).slice(0,5),o=l=>{const d=document.createElement("tr"),m=document.createElement("td");return m.colSpan=4,m.textContent=l,m.style.fontWeight="bold",m.style.textAlign="center",m.style.backgroundColor="var(--cell-border)",d.appendChild(m),d},r=(l,d)=>{const m=document.createElement("tr"),C=document.createElement("td");C.textContent=l.mode,m.appendChild(C);const T=document.createElement("td");T.textContent=l.score,m.appendChild(T);const R=document.createElement("td");R.textContent=l.time,m.appendChild(R);const L=document.createElement("td");return L.textContent=d?"Win":"Loss",L.className=d?"win-indicator":"loss-indicator",m.appendChild(L),m},c=s.results.filter(l=>l.win),i=s.results.filter(l=>!l.win),u=n(c),g=n(i);u.length>0&&(e.appendChild(o("Wins")),u.forEach(l=>{e.appendChild(r(l,!0))})),g.length>0&&(e.appendChild(o("Loses")),g.forEach(l=>{e.appendChild(r(l,!1))}))},E=e=>{const t=document.getElementById(`${e}-modal`);t&&t.classList.add("active")},v=e=>{const t=document.getElementById(`${e}-modal`);t&&t.classList.remove("active")},B=e=>{const t=document.getElementById("alert-message");t&&(t.textContent=e),E("alert")},_=e=>new Promise(t=>{const n=document.getElementById("confirm-message");n&&(n.textContent=e);const o=document.getElementById("confirm-yes"),r=document.getElementById("confirm-no"),c=()=>{o.removeEventListener("click",i),r.removeEventListener("click",u),v("confirm")},i=()=>{c(),t(!0)},u=()=>{c(),t(!1)};o.addEventListener("click",i),r.addEventListener("click",u),E("confirm")}),x=(e,t)=>{const n=document.createElement("div");n.className="modal",n.id=`${e}-modal`;const o=document.createElement("div");o.className="modal-content";const r=document.createElement("div");r.className="modal-header";const c=document.createElement("div");c.className="modal-title",c.textContent=t;const i=document.createElement("button");return i.className="close-modal",i.innerHTML="&times;",i.addEventListener("click",()=>v(e)),r.appendChild(c),r.appendChild(i),o.appendChild(r),n.appendChild(o),{modal:n,content:o}},le=()=>{const{modal:e,content:t}=x("settings","Settings"),n=document.createElement("div");n.className="settings-option";const o=document.createElement("label"),r=document.createElement("input");r.type="checkbox",r.id="audio-toggle",r.checked=s.settings.audio,o.appendChild(r),o.appendChild(document.createTextNode("Enable Sound Effects")),n.appendChild(o),t.appendChild(n);const c=document.createElement("div");c.className="settings-option";const i=document.createElement("div");i.textContent="Theme:",c.appendChild(i);const u=document.createElement("div");u.className="theme-selector";const g=s.settings.theme||"light",l=document.createElement("button");l.className=`theme-btn ${g==="light"?"active":""}`,l.textContent="Light",l.dataset.theme="light",l.addEventListener("click",()=>P("light"));const d=document.createElement("button");return d.className=`theme-btn ${g==="dark"?"active":""}`,d.textContent="Dark",d.dataset.theme="dark",d.addEventListener("click",()=>P("dark")),u.appendChild(l),u.appendChild(d),c.appendChild(u),t.appendChild(c),e},ie=()=>{const{modal:e,content:t}=x("results","Game Results"),n=document.createElement("table");n.className="results-table",n.id="results-table";const o=document.createElement("thead"),r=document.createElement("tr");["Mode","Score","Time","Result"].forEach(i=>{const u=document.createElement("th");u.textContent=i,r.appendChild(u)}),o.appendChild(r),n.appendChild(o);const c=document.createElement("tbody");return n.appendChild(c),t.appendChild(n),e},de=()=>{const{modal:e,content:t}=x("outcome","Game"),n=document.createElement("div");n.className="outcome-message",n.id="outcome-message",t.appendChild(n);const o=document.createElement("div");o.className="outcome-details",o.id="outcome-details",t.appendChild(o);const r=document.createElement("div");r.className="post-game-options";const c=(i,u)=>{const g=document.createElement("button");return g.className="control-btn",g.textContent=i,g.addEventListener("click",u),g};return r.appendChild(c("Play Again",()=>{v("outcome"),A(s.currentMode)})),r.appendChild(c("Main Menu",()=>{v("outcome"),y("start")})),r.appendChild(c("View Results",()=>{v("outcome"),H(),E("results")})),t.appendChild(r),e},ue=()=>{const{modal:e,content:t}=x("alert","Information"),n=document.createElement("div");n.className="alert-message",n.id="alert-message",t.appendChild(n);const o=document.createElement("button");return o.className="control-btn",o.textContent="OK",o.addEventListener("click",()=>v("alert")),t.appendChild(o),e},me=()=>{const{modal:e,content:t}=x("confirm","Confirmation"),n=document.createElement("div");n.className="confirm-message",n.id="confirm-message",t.appendChild(n);const o=document.createElement("div");o.className="confirm-buttons";const r=document.createElement("button");r.className="control-btn confirm-yes",r.textContent="Yes",r.id="confirm-yes";const c=document.createElement("button");return c.className="control-btn confirm-no",c.textContent="No",c.id="confirm-no",o.appendChild(r),o.appendChild(c),t.appendChild(o),e},ge=()=>{[{name:"settings",creator:le},{name:"results",creator:ie},{name:"outcome",creator:de},{name:"alert",creator:ue},{name:"confirm",creator:me}].forEach(({name:t,creator:n})=>{a[`${t}Modal`]=n(),document.body.appendChild(a[`${t}Modal`])})},Y=()=>{const e=[],t=[];for(let n=0;n<s.grid.length;n++)for(let o=0;o<s.grid[n].length;o++)s.grid[n][o]!==null&&t.push({row:n,col:o,value:s.grid[n][o]});for(let n=0;n<t.length;n++)for(let o=n+1;o<t.length;o++){const r=t[n],c=t[o];(r.value===c.value||r.value+c.value===10)&&V(r,c)&&e.push({cell1:r,cell2:c})}return e},he=()=>{if(s.history.length>0&&s.assists.revert.uses<s.assists.revert.max){const e=s.history.pop();s.grid=e.grid,s.score=e.score,s.selectedCells=e.selectedCells,s.assists.revert.uses++,b(),M(),p(),h("assist")}},pe=()=>{let e=0;for(let t=0;t<s.grid.length;t++)for(let n=0;n<s.grid[t].length;n++)s.grid[t][n]!==null&&e++;return e},fe=e=>{document.querySelectorAll(".cell").forEach(n=>{n.classList.remove("hint-highlight")}),e.forEach(n=>{const o=document.querySelector(`.cell[data-row="${n.cell1.row}"][data-col="${n.cell1.col}"]`),r=document.querySelector(`.cell[data-row="${n.cell2.row}"][data-col="${n.cell2.col}"]`);o&&r&&(o.classList.add("hint-highlight"),r.classList.add("hint-highlight"))}),setTimeout(()=>{document.querySelectorAll(".cell").forEach(o=>{o.classList.remove("hint-highlight")})},3e3)},Ce=()=>{const e=Y(),t=e.length,n=document.getElementById("hints-counter");t>5?n.textContent="5+":n.textContent=t.toString(),fe(e),h("assist")},ve=()=>{if(s.assists.shuffle.uses<s.assists.shuffle.max){s.assists.shuffle.uses++;const e=[];for(let n=0;n<s.grid.length;n++)for(let o=0;o<s.grid[n].length;o++)s.grid[n][o]!==null&&e.push(s.grid[n][o]);W(e);let t=0;for(let n=0;n<s.grid.length;n++)for(let o=0;o<s.grid[n].length;o++)s.grid[n][o]!==null&&(s.grid[n][o]=e[t],t++);b(),p(),h("assist")}},W=e=>{for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e},Ee=()=>{s.assists.eraser.uses<s.assists.eraser.max&&(s.eraserActive=!0,s.assists.eraser.uses++,b(),h("assist"),B("Click on any number to remove it. This will use one eraser."))},ye=async()=>{if(s.timerInterval&&(clearInterval(s.timerInterval),s.timerInterval=null),!ae()&&!await _("Your progress is not saved. Are you sure you want to return to the main menu?")){s.gameOver||$();return}O(),y("start"),h("assist")},be=e=>{let t=0,n=Math.floor(s.totalCellsAdded/9),o=s.totalCellsAdded%9;for(;t<e.length;){if(n>=s.grid.length){if(s.grid.length>=50)break;s.grid.push(Array(9).fill(null))}s.grid[n][o]=e[t],t++,s.totalCellsAdded++,o++,o>=9&&(n++,o=0)}},Se=()=>{if(s.grid.length>=50){B("Grid limit reached! Cannot add more numbers.");return}if(s.assists.addNumbers.uses<s.assists.addNumbers.max){s.assists.addNumbers.uses++;const e=[],t=pe();if(s.currentMode==="classic")for(let n=0;n<t;n++)e.push(f[s.classicSequenceIndex]),s.classicSequenceIndex=(s.classicSequenceIndex+1)%f.length;else if(s.currentMode==="random")for(let n=0;n<t;n++){const o=Math.floor(Math.random()*f.length);e.push(f[o])}else if(s.currentMode==="chaotic")for(let n=0;n<t;n++)e.push(Math.floor(Math.random()*9)+1);be(e),b(),p(),h("assist"),s.grid.length>=50&&w(!1)}},xe=()=>{Object.values(a.modeButtons).forEach(e=>{e.addEventListener("click",t=>{const n=t.target.dataset.mode;A(n)})}),a.continueButton.addEventListener("click",()=>{U()&&y("game")}),a.controlButtons.exit.addEventListener("click",async()=>{try{await ye()}catch(e){console.error("Error in exit handler:",e)}}),a.settingsButton.addEventListener("click",()=>E("settings")),a.resultsButton.addEventListener("click",()=>{H(),E("results")}),a.controlButtons.reset.addEventListener("click",async()=>{try{await _("Are you sure you want to reset the game?")&&A(s.currentMode)}catch(e){console.error("Error in reset handler:",e)}}),a.controlButtons.save.addEventListener("click",re),a.controlButtons.continue.addEventListener("click",()=>{U()&&y("game")}),a.assistButtons.hints.addEventListener("click",Ce),a.assistButtons.revert.addEventListener("click",he),a.assistButtons.addNumbers.addEventListener("click",Se),a.assistButtons.shuffle.addEventListener("click",ve),a.assistButtons.eraser.addEventListener("click",Ee),document.getElementById("audio-toggle").addEventListener("change",e=>{s.settings.audio=e.target.checked,O()}),[a.settingsModal,a.resultsModal,a.outcomeModal].forEach(e=>{e.addEventListener("click",t=>{t.target===e&&v(e.id.replace("-modal",""))})})},y=e=>{Object.values(a.screens).forEach(t=>{t.classList.remove("active")}),a.screens[e].classList.add("active"),s.currentScreen=e},we=()=>{const e=a.screens.game,t=document.createElement("div");t.className="game-header",a.modeInfo=document.createElement("div"),a.modeInfo.className="mode-info",a.modeInfo.textContent=`Mode: ${s.currentMode||"Classic"}`,t.appendChild(a.modeInfo),a.scoreDisplay=document.createElement("div"),a.scoreDisplay.className="score-display",a.scoreDisplay.textContent="Score: 0 / 100",t.appendChild(a.scoreDisplay),a.timerDisplay=document.createElement("div"),a.timerDisplay.className="timer-display",a.timerDisplay.textContent="00:00",t.appendChild(a.timerDisplay),e.appendChild(t);const n=document.createElement("div");n.className="progress-container";const o=document.createElement("div");o.className="progress-bar",o.id="progress-bar",n.appendChild(o),e.appendChild(n);const r=document.createElement("div");r.className="game-controls";const c=[{id:"reset",text:"Reset"},{id:"save",text:"Save Game"},{id:"continue",text:"Continue"},{id:"exit",text:"Back to Menu"}];a.controlButtons={},c.forEach(l=>{const d=document.createElement("button");d.className="control-btn",d.id=`${l.id}-btn`,d.textContent=l.text,r.appendChild(d),a.controlButtons[l.id]=d}),e.appendChild(r),a.gameGrid=document.createElement("div"),a.gameGrid.className="game-grid",e.appendChild(a.gameGrid);const i=document.createElement("div");i.className="assist-tools";const u=[{id:"hints",text:"Hints",counter:!0},{id:"revert",text:"Revert",counter:!0},{id:"addNumbers",text:"Add Numbers",counter:!0},{id:"shuffle",text:"Shuffle",counter:!0},{id:"eraser",text:"Eraser",counter:!0}];a.assistButtons={},u.forEach(l=>{const d=document.createElement("button");d.className="assist-btn",d.id=`${l.id}-btn`;const m=document.createElement("span");if(m.textContent=l.text,d.appendChild(m),l.counter){const C=document.createElement("span");C.className="usage-counter",C.id=`${l.id}-counter`,C.textContent="∞",d.appendChild(C)}i.appendChild(d),a.assistButtons[l.id]=d}),e.appendChild(i);const g=document.createElement("button");g.className="settings-btn",g.textContent="Settings",g.style.margin="20px auto 0",g.style.display="flex",e.appendChild(g),g.addEventListener("click",()=>{E("settings")})},Ne=()=>{if(s.score>=100){w(!0);return}const e=Y(),t=Object.values(s.assists).every(n=>n.uses>=n.max);if(e.length===0&&t){w(!1);return}if(s.grid.length>=50){w(!1);return}},Be=(e,t)=>{s.grid[e][t]!==null&&(s.grid[e][t]=null,p())},V=(e,t)=>{if(e.row===t.row&&e.col===t.col)return!1;if(Math.abs(e.row-t.row)===1&&e.col===t.col||Math.abs(e.col-t.col)===1&&e.row===t.row)return!0;if(e.row===t.row){const n=Math.min(e.col,t.col),o=Math.max(e.col,t.col);for(let r=n+1;r<o;r++)if(s.grid[e.row][r]!==null)return!1;return!0}if(e.col===t.col){const n=Math.min(e.row,t.row),o=Math.max(e.row,t.row);for(let r=n+1;r<o;r++)if(s.grid[r][e.col]!==null)return!1;return!0}if(Math.abs(e.row-t.row)===1){const n=e.row<t.row?e:t,o=e.row<t.row?t:e;if(n.col===8&&o.col===0)return!0}return!1},J=()=>{s.selectedCells.forEach(e=>{const t=document.querySelector(`.cell[data-row="${e.row}"][data-col="${e.col}"]`);t&&(t.classList.add("invalid-pair"),setTimeout(()=>{t.classList.remove("invalid-pair")},500))})},k=()=>{const e=document.getElementById("hints-counter");e&&(e.textContent="∞")},Me=()=>{if(s.selectedCells.length!==2){s.selectedCells=[],p();return}const[e,t]=s.selectedCells;if(!e||!t){s.selectedCells=[],p();return}if(!s.grid[e.row]||!s.grid[t.row]||s.grid[e.row][e.col]===null||s.grid[t.row][t.col]===null){h("invalid"),s.selectedCells=[],p();return}const n=s.grid[e.row][e.col],o=s.grid[t.row][t.col];if(!V(e,t)){h("invalid"),J(),s.selectedCells=[],p();return}let r=0,c=!1;n===5&&o===5?(r=3,c=!0):n===o?(r=1,c=!0):n+o===10&&(r=2,c=!0),c?(h("valid"),s.history.push({grid:JSON.parse(JSON.stringify(s.grid)),score:s.score,selectedCells:[...s.selectedCells]}),s.score+=r,s.grid[e.row][e.col]=null,s.grid[t.row][t.col]=null,s.selectedCells=[],s.assists.revert.uses=0,M(),p(),Ne(),k()):(h("invalid"),J(),s.selectedCells=[],p(),k())},w=e=>{s.gameOver=!0,clearInterval(s.timerInterval);const t={mode:s.currentMode,score:s.score,time:I(s.timer),win:e,timestamp:new Date().toISOString()};s.results.unshift(t),s.results.length>5&&s.results.pop(),ne();const n=document.getElementById("outcome-message"),o=document.getElementById("outcome-details");o.innerHTML="",e?(n.textContent="Congratulations! You Won!",n.style.color="var(--success-color)",h("win")):(n.textContent="Game Over",n.style.color="var(--accent-color)",h("lose"));const r=document.createElement("p");r.textContent=`Score: ${s.score}`;const c=document.createElement("p");c.textContent=`Time: ${I(s.timer)}`;const i=document.createElement("p");i.textContent=`Mode: ${s.currentMode}`,o.appendChild(r),o.appendChild(c),o.appendChild(i),E("outcome")},b=()=>{const e=document.getElementById("revert-counter");e&&(e.textContent=`${s.assists.revert.uses}/${s.assists.revert.max}`),a.assistButtons.revert.disabled=s.assists.revert.uses>=s.assists.revert.max;const t=document.getElementById("addNumbers-counter");t&&(t.textContent=`${s.assists.addNumbers.uses}/${s.assists.addNumbers.max}`),a.assistButtons.addNumbers.disabled=s.assists.addNumbers.uses>=s.assists.addNumbers.max||s.grid.length>=50;const n=document.getElementById("shuffle-counter");n&&(n.textContent=`${s.assists.shuffle.uses}/${s.assists.shuffle.max}`),a.assistButtons.shuffle.disabled=s.assists.shuffle.uses>=s.assists.shuffle.max;const o=document.getElementById("eraser-counter");o&&(o.textContent=`${s.assists.eraser.uses}/${s.assists.eraser.max}`),a.assistButtons.eraser.disabled=s.assists.eraser.uses>=s.assists.eraser.max},Le=e=>{if(s.gameOver)return;const t=parseInt(e.target.dataset.row),n=parseInt(e.target.dataset.col);if(isNaN(t)||isNaN(n)){console.error("Invalid cell coordinates:",t,n);return}if(t>=s.grid.length||!s.grid[t]){console.error("Row does not exist in grid:",t,"Grid length:",s.grid.length);return}if(n>=s.grid[t].length||s.grid[t][n]===void 0){console.error("Column does not exist in row:",n,"Row length:",s.grid[t].length);return}if(s.grid[t][n]===null)return;if(s.eraserActive){Be(t,n),s.eraserActive=!1,b();return}s.selectedCells.some(r=>r.row===t&&r.col===n)?(s.selectedCells=s.selectedCells.filter(r=>!(r.row===t&&r.col===n)),h("select")):(s.selectedCells.length<2&&(s.selectedCells.push({row:t,col:n}),h("select")),s.selectedCells.length===2&&setTimeout(Me,300)),p()},Ie=()=>{document.querySelectorAll(".screen").forEach(t=>t.remove()),a.screens={start:document.createElement("div"),game:document.createElement("div"),results:document.createElement("div")},a.screens.start.className="screen start-screen",a.screens.game.className="screen game-screen",a.screens.results.className="screen results-screen",ee(),we(),ce(),ge(),document.body.appendChild(a.screens.start),document.body.appendChild(a.screens.game),document.body.appendChild(a.screens.results),a.screens.start.classList.add("active")},ke=async()=>{Ie(),oe(),xe(),y("start"),te(),se(),G(s.settings.theme)},p=()=>{a.gameGrid.innerHTML="";for(let e=0;e<s.grid.length;e++)for(let t=0;t<s.grid[e].length;t++){const n=document.createElement("div");n.className="cell",n.dataset.row=e.toString(),n.dataset.col=t.toString(),s.grid[e][t]!==null?(n.textContent=s.grid[e][t],n.addEventListener("click",Le)):n.classList.add("empty"),s.selectedCells.some(o=>o.row===e&&o.col===t)&&n.classList.add("selected"),a.gameGrid.appendChild(n)}},Ae=e=>{if(s.grid=[],s.classicSequenceIndex=0,e==="classic")for(let t=0;t<3;t++){const n=[];for(let o=0;o<9;o++){const r=t*9+o;r<f.length?(n.push(f[r]),s.classicSequenceIndex=(r+1)%f.length):n.push(null)}s.grid.push(n)}else if(e==="random"){const t=[...f];W(t);for(let n=0;n<3;n++){const o=[];for(let r=0;r<9;r++){const c=n*9+r;c<t.length?o.push(t[c]):o.push(null)}s.grid.push(o)}}else if(e==="chaotic")for(let t=0;t<3;t++){const n=[];for(let o=0;o<9;o++)n.push(Math.floor(Math.random()*9)+1);s.grid.push(n)}s.totalCellsAdded=27,p()},A=e=>{s.currentMode=e,s.score=0,s.timer=0,s.selectedCells=[],s.gameOver=!1,s.history=[],s.totalCellsAdded=0,s.classicSequenceIndex=0,Object.keys(s.assists).forEach(t=>{s.assists[t].uses=0}),s.assists.revert.uses=0,Ae(e),M(),$(),y("game"),h("assist")};document.addEventListener("DOMContentLoaded",ke);
